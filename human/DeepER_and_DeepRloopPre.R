# ------------------------------------------------------------------------------
# Purpose:
#   This section loads and visualizes base-resolution R-loop probability scores
#   generated by DeepER for the KY962518 rDNA repeat (with +3500 nt extended IGS).
#   DeepER outputs a single-line comma-separated text file containing probability
#   values for every nucleotide in the input FASTA. These values are reshaped into
#   a position-indexed table and plotted as:
#       (1) a simple base-by-base line plot, and
#       (2) a karyotype-style ideogram track aligned to annotated rDNA features
#           (promoter, 5′ETS, 18S, ITS1, 5.8S, ITS2, 28S, 3′ETS, and IGS).
#
#   Both template and nontemplate DeepER outputs are processed identically.
#   GRanges objects are created to enable genome-like visualization using
#   karyoploteR. A second figure zooms in on the transcriptional unit
#   (5′ETS → 3′ETS), allowing direct comparison of R-loop probability profiles
#   along functional rDNA elements.
#
# Major Steps:
#   1. Load DeepER TXT output and reshape to a numeric probability vector.
#      - DeepER outputs a single line of comma-separated probabilities.
#      - Convert to a data frame and assign sequential base positions.
#
#   2. Generate a basic line plot of R-loop probability across the full rDNA unit.
#      - Provides a first-pass overview of DeepER predictions.
#
#   3. Convert DeepER results into a GRanges object for track-style visualization.
#      - Each base becomes a 1-bp genomic interval with a probability score.
#
#   4. Plot DeepER data on a custom karyotype of KY962518 using karyoploteR.
#      - Add colored rectangles marking each annotated rDNA region.
#      - Overlay DeepER probability as a signal track across the ideogram.
#
#   5. Extract a subrange (1–19,000 bp) for zoomed 5′ETS→3′ETS visualization.
#      - Used for high-resolution inspection of R-loop formation across the
#        transcribed region of the rDNA repeat.
#
#   6. (Optional) Convert DeepER scores into BED peaks.
#      - Sliding window (200 bp, step 10 bp) with mean probability threshold.
#      - Windows above threshold are merged to yield contiguous R-loop–positive
#        intervals suitable for downstream BED-based analyses.
#
 ------------------------------------------------------------------------------


### Load DeepER TXT output
# Example line in your .txt:
# KY962518(0-4999)    0.02386,0.00530,0.00287,...
library(data.table)
library(tidyverse)
library(karyoploteR)

line <- fread("DeepER_KY962518_added_3500nt_IGS_upstream_nontemplate_output.txt", sep = ",", header = FALSE)
deepER<- t(as.data.frame(line))
class(deepER)
#[1] "matrix" "array" 
deepER <- as.data.frame(deepER)
class(deepER)
#[1] "data.frame"
colnames(deepER)<- c("R-loop_probability")
deepER$position <- seq_len(nrow(deepER))


plot(
  deepER$position,
  deepER$R_loop_probability,
  type = "l",          # line plot
  col = "blue",
  lwd = 1.4,
  xlab = "Base Position (1 → end of sequence)",
  ylab = "R-loop Probability",
  main = "DeepER Base-level R-loop Probability"
)




#library(GenomicRanges)

deepER_gr <- GRanges(
  seqnames = "KY962518",
  ranges = IRanges(start = deepER$position, end = deepER$position),
  score = deepER$`R-loop_probability`
)


custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=48338))
#end is 48338 because I added 3500 to 44838
#changing  colors 

kp <- plotKaryotype(genome=custom_genome, plot.type = 2)

kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 48338, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS
#16833+ (31506-1)= 48338


kpRect(kp, chr = 'KY962518', x0 = 46137, x1 = 48338, y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202bp of promoter
#48338-2201

kpLines(kp, data = deepER_gr, y = deepER_gr$score, col="#E21515", r0=0, r1=0.4)



#need to plot only from 5'ETS to 3'ETS
deepER_subset <- deepER_gr[
  start(deepER_gr) >= 1 & end(deepER_gr) <= 19000
]

png("rdna_nontemplate_DeepER_coverage.png", width = 10, height= 10, units= "in", res = 600)

custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=19000))
kp <- plotKaryotype(genome=custom_genome, plot.type = 2)


#need to plot only from 5'ETS to 3'ETS
#png("rdna_nontemplate_deepER_coverage_1.png", width = 10, height= 10, units= "in", res = 600)


kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 19000, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS

#16472+(361-1) = 16832

kpAxis(kp, ymin = 0, ymax = 1, r0 = 0, r1 = 0.6, cex = 2)

kpLines(kp, data = deepER_subset, y = deepER_subset$score, col="#E21515", r0=0, r1=0.6, lwd =5)
dev.off()

#did the same for template:

line <- fread("DeepER_KY962518_added_3500nt_IGS_upstream_template_output.txt", sep = ",", header = FALSE)
deepER<- t(as.data.frame(line))
class(deepER)
#[1] "matrix" "array" 
deepER <- as.data.frame(deepER)
class(deepER)
#[1] "data.frame"
colnames(deepER)<- c("R-loop_probability")
deepER$position <- seq_len(nrow(deepER))

deepER_gr <- GRanges(
  seqnames = "KY962518",
  ranges = IRanges(start = deepER$position, end = deepER$position),
  score = deepER$`R-loop_probability`
)

deepER_subset <- deepER_gr[
  start(deepER_gr) >= 1 & end(deepER_gr) <= 19000
]


#need to plot only from 5'ETS to 3'ETS
png("rdna_nontemplate_DeepER_coverage.png", width = 10, height= 10, units= "in", res = 600)


custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=19000))
kp <- plotKaryotype(genome=custom_genome, plot.type = 2)


#need to plot only from 5'ETS to 3'ETS
#png("rdna_nontemplate_deepER_coverage_1.png", width = 10, height= 10, units= "in", res = 600)


kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 19000, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS

#16472+(361-1) = 16832

kpAxis(kp, ymin = 0, ymax = 1, r0 = 0, r1 = 0.6, cex = 2)

kpLines(kp, data = deepER_subset, y = deepER_subset$score, col="#1414E1", r0=0, r1=0.6, lwd =5)
dev.off()

deepER_gr <- GRanges(
  seqnames = "KY962518",
  ranges = IRanges(start = deepER$position, end = deepER$position),
  score = deepER$`R-loop_probability`
)


custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=48338))
#end is 48338 because I added 3500 to 44838
#changing  colors 

kp <- plotKaryotype(genome=custom_genome, plot.type = 2)

kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 48338, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS
#16833+ (31506-1)= 48338


kpRect(kp, chr = 'KY962518', x0 = 46137, x1 = 48338, y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202bp of promoter
#48338-2201

kpLines(kp, data = deepER_gr, y = deepER_gr$score, col="#1414E1", r0=0, r1=0.4)

###################
# if you want to make bed file

window_size <- 200
step_size <- 10
threshold <- 0.95


#First window = bases 1–200
#Next window = bases 11–210
#Next window = bases 21–220… and so on


## Extract probability vector (your DeepER results)
probs <- deepER$`R-loop_probability`
n <- length(probs)

# 1. Define window start positions
window_starts <- seq(1, n - window_size + 1, by = step_size)


# 2. Compute mean probability in each window
window_results <- data.frame(
  start = window_starts,
  end = window_starts + window_size - 1,
  mean_prob = sapply(window_starts, function(i) {
    mean(probs[i:(i + window_size - 1)])
  })
)

# 3. Keep windows above threshold (R-loop-positive)
rl_windows <- subset(window_results, mean_prob >= threshold)


# 4. Merge overlapping/adjacent windows
merge_windows <- function(df) {
  if (nrow(df) == 0) return(df)
  
  df <- df[order(df$start), ]
  
  merged <- list()
  current_start <- df$start[1]
  current_end <- df$end[1]
  
  for (i in 2:nrow(df)) {
    if (df$start[i] <= current_end) {
      # extend region
      current_end <- max(current_end, df$end[i])
    } else {
      # push current region and start a new one
      merged[[length(merged) + 1]] <- c(current_start, current_end)
      current_start <- df$start[i]
      current_end <- df$end[i]
    }
  }
  
  merged[[length(merged) + 1]] <- c(current_start, current_end)
  
  merged_df <- do.call(rbind, merged)
  colnames(merged_df) <- c("start", "end")
  merged_df
}

merged_regions <- merge_windows(rl_windows)

chrom <- "KY962518"

bed <- data.frame(
  chrom = chrom,
  start = merged_regions$start - 1,   # BED is 0-based
  end = merged_regions$end,
  name = "DeepER"
)

########################################################
#DeepRloopPre
nontemplate<- fread("KY962518_nontemplate_DeepRloopPre_final_predict.bed", sep = "\t", header = FALSE)
template<- fread("KY962518_template_DeepRloopPre_final_predict.bed", sep = "\t", header = FALSE)
template$V1<- "KY962518"
template$V6<- "-"

template_gr <- toGRanges(template[, c("V1","V2","V3")])
template_gr$score <- template$V5

nontemplate_original<- nontemplate
#added random numbers so that kplines starts from zero
nontemplate <- rbind(data.table(
  V1 = c("KY962518","KY962518","KY962518","KY962518"),
  V2 = c(0,1001, 2001, 3001),
  V3 = c(1000, 2000, 3000, 4351),
  V4 = c("KY962518_nontemplate_peak_1","KY962518_nontemplate_peak_1","KY962518_nontemplate_peak_1","KY962518_nontemplate_peak_1"),
  V5 = c(0.0,0.0,0.0,0.0),
  V6 = c("+","+","+","+")
), nontemplate)

nontemplate_gr <- toGRanges(nontemplate[, c("V1","V2","V3")])
nontemplate_gr$score <- nontemplate$V5






png("rdna_template_DeepRloopPre_coverage.png", width = 10, height= 10, units= "in", res = 600)


custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=19000))
kp <- plotKaryotype(genome=custom_genome, plot.type = 2)


#need to plot only from 5'ETS to 3'ETS
#png("rdna_nontemplate_deepER_coverage_1.png", width = 10, height= 10, units= "in", res = 600)


kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 19000, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS

#16472+(361-1) = 16832

kpLines(kp, data = template_gr, y = template_gr$score, col="#1414E1", r0=0, r1=0.6, lwd =5)
kpPlotRegions(kp, data=template, data.panel=1, col = "#1414E1",r0=0, r1=0.1)
dev.off()

png("rdna_nontemplate_DeepER_coverage.png", width = 10, height= 10, units= "in", res = 600)
custom_genome <- toGRanges(data.frame(chr="KY962518", start=1, end=19000))
kp <- plotKaryotype(genome=custom_genome, plot.type = 2)


#need to plot only from 5'ETS to 3'ETS
#png("rdna_nontemplate_deepER_coverage_1.png", width = 10, height= 10, units= "in", res = 600)


kpRect(kp, chr = 'KY962518', x0 = 1, x1 =1298 , y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks last 1298bp from IGS representing previous rdna 
kpRect(kp, chr = 'KY962518', x0 = 1299, x1 =3500 , y0 = 0, y1 = 1, col = "#B6FFF4", data.panel = "ideogram", borders= NA) #marks 2202 bp of  promoter

kpRect(kp, chr = 'KY962518', x0 = 3501, x1 = 7157 , y0 = 0, y1 = 1, col = "#FDCCE5", data.panel = "ideogram", borders= NA) #marks 5'ETS (3501+(3657-1))
#3501+(3657-1) = 7157

kpRect(kp, chr = 'KY962518', x0 = 7158, x1 = 9026, y0 = 0, y1 = 1, col = "#D0B6FF", data.panel = "ideogram", borders= NA) #marks 18S
#7158+ (1869-1) = 9026

kpRect(kp, chr = 'KY962518', x0 = 9027, x1 = 10096, y0 = 0, y1 = 1, col = "#EF9B20", data.panel = "ideogram", borders= NA) #marks ITS1S
#9027+ (1070-1) = 10096 

kpRect(kp, chr = 'KY962518', x0 = 10097, x1 = 10253, y0 = 0, y1 = 1, col = "#A0322B", data.panel = "ideogram", borders= NA) #marks 5.8S
#10097+ (157-1) = 10253

kpRect(kp, chr = 'KY962518', x0 = 10254, x1 = 11420, y0 = 0, y1 = 1, col = "#FFCC17", data.panel = "ideogram", borders= NA) #marks ITS2
#10254+(1167-1) = 11420

kpRect(kp, chr = 'KY962518', x0 = 11421, x1 = 16471, y0 = 0, y1 = 1, col = "#E5FFB6", data.panel = "ideogram", borders= NA) #marks 28S
#11421+(5051-1) = 16471

kpRect(kp, chr = 'KY962518', x0 = 16472, x1 = 16832, y0 = 0, y1 = 1, col = "#3B8CC4", data.panel = "ideogram", borders= NA) #marks 3'ETS
#16472+(361-1) = 16832

kpRect(kp, chr = 'KY962518', x0 = 16833, x1 = 19000, y0 = 0, y1 = 1, col = "#A4A2A8", data.panel = "ideogram", borders= NA) #marks IGS

#16472+(361-1) = 16832

kpLines(kp, data = nontemplate_gr, y = nontemplate_gr$score, col="#E21515", r0=0, r1=0.6, lwd =5)
kpPlotRegions(kp, data=nontemplate_original, data.panel=1, col = "#E21515",r0=0, r1=0.1)
dev.off()

